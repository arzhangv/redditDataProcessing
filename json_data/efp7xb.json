{
    "op": {
        "upvote_ratio": null,
        "selftext": "One of my clients is with an MSP that got infected with the REvil / Sodinokibi ransomware, anyone know if any Decrypter tools have been developed or its still too new? Also, I'm wondering if this one is the real deal as I did noticed something strange with some Veeam backups did not get encrypted even know the encryption made it to the folder where the backups resided\n\nAny info would be great thanks",
        "title": "MSP Got infected by REvil / Sodinokibi Ransomware",
        "score": 1,
        "id": "efp7xb",
        "commsNum": 23,
        "timeStamp": "2019/12/25-18:03:08",
        "author_name": "socalccna",
        "is_self": true,
        "locked": false,
        "num_comments": 23,
        "over_18": false,
        "spoiler": false,
        "subreddit": "malware",
        "stickied": false,
        "url": "https://www.reddit.com/r/Malware/comments/efp7xb/msp_got_infected_by_revil_sodinokibi_ransomware/"
    },
    "posts": {
        "fldccu8": {
            "comment": "That is until you look up REvil and the threat actors and realize that they will dump any and all exfiltrated data if the ransom is not paid.\n\nBack in the days of yore we might have been able to get away with this thought process, but it is not nearly as black and white now.",
            "timeStamp": "2020/03/24-07:52:57",
            "id": "fldccu8",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1t20n",
            "score": 1,
            "stickied": false,
            "author_name": "blahdidbert"
        },
        "fh6wd1t": {
            "comment": "[removed]",
            "timeStamp": "2020/02/09-20:09:52",
            "id": "fh6wd1t",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t3_efp7xb",
            "score": 1,
            "stickied": false,
            "author_name": "[deleted]"
        },
        "fc4279g": {
            "comment": "Erm, not really. For a given backup, one would test to see if files open. If files don't open, assume backup is corrupt, and restore from a clean copy of the same backup that was duplicated off site, or try another slightly older backup.",
            "timeStamp": "2019/12/26-15:58:03",
            "id": "fc4279g",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc3duc0",
            "score": 1,
            "stickied": false,
            "author_name": "kirashi3"
        },
        "fc3duc0": {
            "comment": "Because it would be impossible to tell which back ups are infected",
            "timeStamp": "2019/12/26-11:13:23",
            "id": "fc3duc0",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc3ckcd",
            "score": 1,
            "stickied": false,
            "author_name": "ImAtWorkRightNowSry"
        },
        "fc3ckcd": {
            "comment": "Why would it be impossible to recover? You'd still have copies of the backup you're restoring from off-site in cold storage, allowing you to make more copies if needed.",
            "timeStamp": "2019/12/26-11:00:01",
            "id": "fc3ckcd",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc2oas1",
            "score": 1,
            "stickied": false,
            "author_name": "kirashi3"
        },
        "fc2rd2k": {
            "comment": "Very few lock the machine. Most are just very simply written to search for a set of pre-established file extensions and encrypt each, some going the extra step of having a pre-established list of system files that it'll skip.\n\nNuking the machine can prevent root cause analysis and could mean that the system is still available for further infection in the future, especially if the attack was caused by an RDP connection.",
            "timeStamp": "2019/12/26-06:49:40",
            "id": "fc2rd2k",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc23v6r",
            "score": 1,
            "stickied": false,
            "author_name": "LightningRurik"
        },
        "fc2r5v9": {
            "comment": "Run `magic` / `file` on all the files and compare against their expected content or file extension. If they're encrypted they'll likely result as just \"data\".",
            "timeStamp": "2019/12/26-06:46:48",
            "id": "fc2r5v9",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1t6d5",
            "score": 1,
            "stickied": false,
            "author_name": "LightningRurik"
        },
        "fc2oas1": {
            "comment": "Usually if the attacker is smart enough he will wait to deploy the ransom after a couple different backups are made, making it virtually impossible to recover without having an infected version of files.",
            "timeStamp": "2019/12/26-06:02:52",
            "id": "fc2oas1",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1t20n",
            "score": 1,
            "stickied": false,
            "author_name": "ImAtWorkRightNowSry"
        },
        "fc2f4hv": {
            "comment": "This is about the Veeam backups, is it? I would check if a valid backup file has some kind of file marker/magic number using a hex editor. Then check if that is also there for the backups on the infected system.",
            "timeStamp": "2019/12/26-02:36:44",
            "id": "fc2f4hv",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1t6d5",
            "score": 1,
            "stickied": false,
            "author_name": "Struppigel"
        },
        "fc2f20p": {
            "comment": "There is currently no free decrypter for REvil.\n\nIt is possible that REvil doesn't target the extension for Veeam backups. Usually ransomware has a list of targeted file extensions. Everything else will not be touched.",
            "timeStamp": "2019/12/26-02:34:44",
            "id": "fc2f20p",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t3_efp7xb",
            "score": 1,
            "stickied": false,
            "author_name": "Struppigel"
        },
        "fc25xbw": {
            "comment": "No worries, thank you for the clarification. I've actually been looking into malware analysis lately (spent that past week learning about PE headers/PE Studio). I hope to be able to learn enough to be able to try to crack ransomwares. Thanks for your input and time.",
            "timeStamp": "2019/12/25-22:30:52",
            "id": "fc25xbw",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc25s9q",
            "score": 1,
            "stickied": false,
            "author_name": "Schnitzel725"
        },
        "fc25s9q": {
            "comment": "Sorry I should have made this distinction. You can try to reverse engineer the malware and figure out the encryption algorithm then brute force it, but that\u2019s different than forensics",
            "timeStamp": "2019/12/25-22:27:45",
            "id": "fc25s9q",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc25n9n",
            "score": 1,
            "stickied": false,
            "author_name": "Trolling_turd"
        },
        "fc25n9n": {
            "comment": "I see, thank you for taking the time to explain. Kind of disappointing to know that doing forensics on it won't be very good towards decrypting.",
            "timeStamp": "2019/12/25-22:24:48",
            "id": "fc25n9n",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc25h0n",
            "score": 1,
            "stickied": false,
            "author_name": "Schnitzel725"
        },
        "fc25h0n": {
            "comment": "It depends on the variant but a lot of times it will just target user specific files such as .docx, .xlsx, pdf etc.. it also can infect system executables which much compromises every program so that it can reinfect the host. This can include  registry files and .dlls. \n\nafter this type of event system logs aren\u2019t reliable as the entire system has potentially been altered.  The best thing you can do is run the sample in a VM and then figure out what it does and then compare against your victim. None of this helps you decrypt the files though. Lateral spread is also a serious concern, so removing the host from the network should be done asap",
            "timeStamp": "2019/12/25-22:21:13",
            "id": "fc25h0n",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc23v6r",
            "score": 1,
            "stickied": false,
            "author_name": "Trolling_turd"
        },
        "fc23v6r": {
            "comment": "But if its ransomware, doesn't it encrypt and lock the box until a payment is made? (Genuine question, haven't really messed with ransomware before) I think at a bare minimum, it would ensure key system files are left normal-ish (enough to run, not enough for normal use). \n\nEvent logs, I dunno about this specific one, but I've seen some other malwares that it deletes the event log entries either entirely or just when the infection starts. Registry is a goldmine if you know where to look, but assuming files are encrypted and the user is locked out of the account, even if you were to image the memory, wouldn't it be near unreadable? (Again, genuine question. I remember trying to do forensics on a malware VM, but until I logged into the account, trying to run the .vmem through Volatility didn't do much)",
            "timeStamp": "2019/12/25-21:49:02",
            "id": "fc23v6r",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc20nuq",
            "score": 1,
            "stickied": false,
            "author_name": "Schnitzel725"
        },
        "fc20nuq": {
            "comment": "You\u2019ve never done forensics for ransomware, have you? If you have, you\u2019re doing it wrong. Ransomware doesn\u2019t encrypt a lot of the file dthat hold main forensic artifacts - like event logs, USN, MFT, registry files for active users, etc. otherwise the OS will break. If that\u2019s that attitude you\u2019re going with - you\u2019re dead wrong.",
            "timeStamp": "2019/12/25-20:50:56",
            "id": "fc20nuq",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc20j24",
            "score": 1,
            "stickied": false,
            "author_name": "w3tmo"
        },
        "fc20j24": {
            "comment": "Not much forensics to do if all the files on disk are encrypted. A memory dump might have some recoverable files or something, but there is really nothing else to do besides pay the ransoms or wait for the keys to leak",
            "timeStamp": "2019/12/25-20:48:37",
            "id": "fc20j24",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1yxaa",
            "score": 1,
            "stickied": false,
            "author_name": "Trolling_turd"
        },
        "fc1yxaa": {
            "comment": "That\u2019s terrible from a legal perspective. Your putting you clients in so much danger without doing forensics. \u201cPave n nuke\u201d is a sure fire way to get them in a law suit. Especially with REvil or Maze ransomware",
            "timeStamp": "2019/12/25-20:22:00",
            "id": "fc1yxaa",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1tj66",
            "score": 1,
            "stickied": false,
            "author_name": "w3tmo"
        },
        "fc1vilj": {
            "comment": "Dont think there is a publicly released tool for the above yet.   \nYou can refer to [https://www.nomoreransom.org/en/decryption-tools.html](https://www.nomoreransom.org/en/decryption-tools.html) in the future for any tools that may be out there.",
            "timeStamp": "2019/12/25-19:30:25",
            "id": "fc1vilj",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t3_efp7xb",
            "score": 1,
            "stickied": false,
            "author_name": "bigbottlequorn"
        },
        "fc1tj66": {
            "comment": "Aside from trying to open the file, no idea - the extent of my malware knowledge stops at \"Oh shit, you got infected. Do you have backups?\" after which I answer depending on their reply.\n\nIf yes, I start estimating how much money I'm about to make, and if no, I start thinking about how much alcohol I'm about to consume.",
            "timeStamp": "2019/12/25-19:00:47",
            "id": "fc1tj66",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1t6d5",
            "score": 1,
            "stickied": false,
            "author_name": "kirashi3"
        },
        "fc1t6d5": {
            "comment": "Regarding my question, if file name wasn't changed and I don't have the Hash of its previous state, anyway to ID if this is encrypted/infected?",
            "timeStamp": "2019/12/25-18:55:25",
            "id": "fc1t6d5",
            "is_submitter": true,
            "link_id": "t3_efp7xb",
            "parent_id": "t1_fc1t20n",
            "score": 1,
            "stickied": false,
            "author_name": "socalccna"
        },
        "fc1t20n": {
            "comment": "Pave N Nuke all systems, then restore from backup. Problem solved.",
            "timeStamp": "2019/12/25-18:53:37",
            "id": "fc1t20n",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t3_efp7xb",
            "score": 1,
            "stickied": false,
            "author_name": "kirashi3"
        },
        "fc1pxrs": {
            "comment": "These guys supposedly have a work around for decrypting the files. \n\n[https://www.coveware.com/contact](https://www.coveware.com/contact)",
            "timeStamp": "2019/12/25-18:06:52",
            "id": "fc1pxrs",
            "is_submitter": false,
            "link_id": "t3_efp7xb",
            "parent_id": "t3_efp7xb",
            "score": 1,
            "stickied": false,
            "author_name": "cpupro"
        }
    }
}